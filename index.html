¬†<!DOCTYPE html>
<html lang="kk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ö”©–±–µ–π—Ç—É –∫–µ—Å—Ç–µ—Å—ñ ‚Äî –¢–µ—Å—Ç</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f4f6fb;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    margin:0;
}

.container{
    width:90%;
    max-width:600px;
    background:#fff;
    padding:30px;
    border-radius:16px;
    box-shadow:0 0 25px rgba(0,0,0,.15);
    text-align:center;
    position:relative;
}

.scoreboard{
    position:absolute;
    right:20px;
    top:20px;
    text-align:right;
}
.scoreboard {
    display: none;
}
#timer{
    display: none;
}

.score{
    font-size:18px;
    font-weight:bold;
}
.correct{color:green;}
.wrong{color:red;}

.topbar{
    display:flex;
    justify-content:center;
    align-items:center;
    gap:20px;
}

button{
    background:#475569;              /* Muted Slate */
    color:#ffffff;
    padding:10px 18px;
    font-size:16px;
    border:none;
    border-radius:12px;
    cursor:pointer;
    transition:0.2s;
}

button:hover{
    background:#334155;
    transform:scale(1.03);
}


#startBtn{
    margin-top: 12px;   /* üîπ tugmalar orasini ochadi */
}

#question{
    font-size:36px;
    font-weight:bold;
    margin:20px 0;
}

input{
    font-size:26px;
    padding:10px;
    width:200px;
    text-align:center;
}

.mobile-answer{
    display:none;
}


#timer{
    font-size:22px;
    color:red;
    font-weight:bold;
}

/* === NUMPAD === */
.numpad-wrap{
    display:flex;
    justify-content:center;
    align-items:flex-end;
    gap:16px;
    margin:20px 0;
    transform:translateX(50px);
}

.numpad{
    display:grid;
    grid-template-columns:repeat(3,90px);
    gap:15px;
}

.key{
    width:90px;
    height:80px;
    font-size:26px;
    font-weight:bold;
    color:#1e293b;
    border-radius:14px;
    border:1px solid #b9c3ff;
    background:linear-gradient(135deg, #f8f9ff, #eef1ff);
    cursor:pointer;
    transition:0.2s;
}

.key:hover{
    background:#d7dcff;
    transform:scale(1.05);
    box-shadow:0 6px 18px rgba(0,0,0,0.12);
}

.key:active{
    transform:scale(0.97);
}


.key:active{
    box-shadow:inset 4px 4px 8px #c5c8ce,
               inset -4px -4px 8px #ffffff;
    transform:scale(.97);
}

.next-key{
    width:90px;
    height:80px;
}

.wrong-list{
    margin:20px auto 0;   /* üîë markazga keltiradi */
    text-align:center;      /* misollar chapdan o‚Äòqiladi */
    font-size:18px;
    max-width:320px;      /* üîë chiroyli eni */
}
.wrong-user{
    color:red;
    font-weight:bold;
}
/* === MOBILE ADAPTATION === */
@media (max-width: 480px){

    .container{
        padding:20px;
    }

    #question{
        font-size:28px;
    }

    input{
        width:160px;
        font-size:22px;
    }

    .numpad-wrap{
        transform:translate(30px);
        gap:10px;
        justify-content:center;
        align-items:flex-end;
        width:100%;
    }

    .numpad{
        grid-template-columns:repeat(3,60px);
        gap:8px;
    }

    .key{
        width:60px;
        height:50px;
        font-size:20px;
        border-radius:10px;
    }

    .next-key{
        width:60px;
        height:50px;
    }
}

/* === FEEDBACK EFFECT === */
.correct-flash{
    animation: correctFlash 0.6s ease-in-out;
}
.wrong-flash{
    animation: wrongFlash 0.6s ease-in-out;
}

@keyframes correctFlash{
    from{ background:#e6ffea; }
    to{ background:#ffffff; }
}

@keyframes wrongFlash{
    from{ background:#ffe6e6; }
    to{ background:#ffffff; }
}

@media (max-width: 480px){

    .scoreboard{
        position: static;
        flex-direction: row;  
        justify-content: center;
        align-items: center;
        gap: 20px;
        margin: 10px 0;
        text-align: center;
    }

    #answer{
        display:none;
    }

    .mobile-answer{
        display:flex;
        justify-content:center;
        align-items:center;
        height:50px;
        width:160px;
        margin:10px auto;
        font-size:26px;
        font-weight:bold;
        border:2px solid #4a6cf7;
        border-radius:12px;
        background:#f4f6fb;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
    }
}

@media (min-width: 481px){
    input{
        caret-color: auto;
    }
}


input{
    caret-color: transparent; /* kursor ko‚Äòrinmaydi */
}



</style>
</head>

<body>
<div class="container">
<h2>–ö”©–±–µ–π—Ç—É –∫–µ—Å—Ç–µ—Å—ñ ‚Äî –¢–µ—Å—Ç</h2>

<div class="topbar" id="topbar">
    <button id="soundBtn" onclick="toggleSound()">üîä –î—ã–±—ã—Å: ON</button>
    <div id="timer">5</div>
</div>

<button id="startBtn" onclick="startGame()">‚ñ∂ –ë–∞—Å—Ç–∞—É</button>

<div class="scoreboard">
    <div class="score correct">‚úÖ –î—É—Ä—ã—Å: <span id="correctCount">0</span></div>
    <div class="score wrong">‚ùå “ö–∞—Ç–µ: <span id="wrongCount">0</span></div>
</div>

<div id="game" style="display:none;">
    <div id="question"></div>

    <input id="answer" inputmode="numeric" placeholder="–ñ–∞—É–∞–ø">
    <div id="mobileAnswer" class="mobile-answer"></div>


    <div class="numpad-wrap">
        <div class="numpad">
            <button class="key" onclick="pressNum(7)">7</button>
            <button class="key" onclick="pressNum(8)">8</button>
            <button class="key" onclick="pressNum(9)">9</button>

            <button class="key" onclick="pressNum(4)">4</button>
            <button class="key" onclick="pressNum(5)">5</button>
            <button class="key" onclick="pressNum(6)">6</button>

            <button class="key" onclick="pressNum(1)">1</button>
            <button class="key" onclick="pressNum(2)">2</button>
            <button class="key" onclick="pressNum(3)">3</button>

            <button class="key" onclick="backspace()">‚å´</button>
            <button class="key" onclick="pressNum(0)">0</button>
            <button class="key" onclick="checkAnswer(false)">‚úî</button>
        </div>

        <button class="key next-key" onclick="nextQuestion()">‚è≠</button>
    </div>
</div>

<div id="summary"></div>
</div>

<audio id="okSound" src="durys.mp3"></audio>
<audio id="errSound" src="qate.mp3"></audio>
<audio id="clickSound" src="click1.mp3"></audio>

<script>
/* ================= AUDIO SYSTEM ================= */

let soundOn = localStorage.getItem("soundOn") !== "false";
let mobileValue = "";

const okSound    = document.getElementById("okSound");
const errSound   = document.getElementById("errSound");
const clickSound = document.getElementById("clickSound");

const sounds = [okSound, errSound, clickSound];
let audioUnlocked = false;

// üîì Brauzer blokini ochish
function unlockAudio(){
    if(audioUnlocked) return;

    sounds.forEach(a=>{
        a.volume = 0.9;
        a.muted = false;
        a.play().then(()=>{
            a.pause();
            a.currentTime = 0;
        }).catch(()=>{});
    });

    audioUnlocked = true;
}

// üîä Ovoz ijro etish (universal)
function playSound(audio){
    if(!soundOn || !audioUnlocked) return;

    audio.pause();
    audio.currentTime = 0;
    audio.play().catch(()=>{});
}

/* ================= TOGGLE BUTTON ================= */

function toggleSound(){
    soundOn = !soundOn;
    localStorage.setItem("soundOn", soundOn);
    document.getElementById("soundBtn").textContent =
        soundOn ? "üîä –î—ã–±—ã—Å: ON" : "üîá –î—ã–±—ã—Å: OFF";
}
// üîÑ Sahifa yuklanganda ovoz tugmasini to‚Äòg‚Äòri holatda ko‚Äòrsatish
window.addEventListener("DOMContentLoaded", () => {
    const btn = document.getElementById("soundBtn");
    btn.textContent = soundOn ? "üîä –î—ã–±—ã—Å: ON" : "üîá –î—ã–±—ã—Å: OFF";
});


/* ================= GAME LOGIC ================= */

let questions=[], wrongList=[];
let index=0, correct=0, wrong=0, checked=false, timer;
const maxQuestions=30;

const container = document.querySelector(".container");
const answer = document.getElementById("answer");
const question = document.getElementById("question");
const game = document.getElementById("game");
const summary = document.getElementById("summary");
const timerEl = document.getElementById("timer");
const correctCountEl = document.getElementById("correctCount");
const wrongCountEl = document.getElementById("wrongCount");

/* ================= START GAME ================= */

function startGame(){
    unlockAudio(); // üîä MUHIM

    document.getElementById("soundBtn").textContent =
        soundOn ? "üîä Ovoz: ON" : "üîá Ovoz: OFF";

    document.getElementById("topbar").style.display = "flex";
    const sb = document.querySelector(".scoreboard");

if (window.innerWidth <= 480) {
    sb.style.display = "flex";
    sb.style.flexDirection = "row";
    sb.style.justifyContent = "center";
    sb.style.alignItems = "center";
    sb.style.gap = "18px";
} else {
    sb.style.display = "block";
}

    timerEl.style.display = "block";

    index = correct = wrong = 0;
    wrongList = [];
    game.style.display = "block";
    document.getElementById("startBtn").style.display = "none";
    correctCountEl.textContent = 0;
    wrongCountEl.textContent = 0;

    // savollar
    let pool = [];
    for(let a=2;a<=9;a++){
        for(let b=1;b<=10;b++){
            pool.push({a,b,ans:a*b});
        }
    }
    pool.sort(()=>Math.random()-0.5);
    questions = pool.slice(0, maxQuestions);

    showQuestion();
}

/* ================= QUESTIONS ================= */

function showQuestion(){
    if(index >= maxQuestions) return finish();

    checked = false;
    const q = questions[index];
    question.textContent = `${q.a} √ó ${q.b} = ?`;
    answer.value = "";
    startTimer();
    mobileValue = "";
    document.getElementById("mobileAnswer").textContent = "";

}

function startTimer(){
    let t = 5;
    timerEl.textContent = t;
    clearInterval(timer);

    timer = setInterval(()=>{
        t--;
        timerEl.textContent = t;
        if(t <= 0){
            clearInterval(timer);
            checkAnswer(false);
        }
    },1000);
}

/* ================= CHECK ANSWER ================= */

function checkAnswer(timeOver){
    if(checked) return;
    checked = true;
    clearInterval(timer);

    const q = questions[index];
    const val = isMobile()
    ? parseInt(mobileValue)
    : parseInt(answer.value);

    // ‚ùå noto‚Äòg‚Äòri yoki vaqt tugadi
    if(timeOver || val !== q.ans){
        wrong++;
        wrongCountEl.textContent = wrong;

        // üî¥ SAVOL JOYIGA TO‚ÄòG‚ÄòRI JAVOBNI YOZAMIZ
        question.textContent = `${q.a} √ó ${q.b} = ${q.ans}`;

        wrongList.push(
            `${q.a} √ó ${q.b} = ${q.ans} (<span class="wrong-user">${isNaN(val)?"‚àí":val}</span>)`
        );

        container.classList.add("wrong-flash");
        setTimeout(()=>container.classList.remove("wrong-flash"),300);

        playSound(errSound);
    }
    // ‚úÖ to‚Äòg‚Äòri
    else{
        correct++;
        correctCountEl.textContent = correct;

        // üîµ SAVOL JOYIGA JAVOBNI YOZAMIZ
        question.textContent = `${q.a} √ó ${q.b} = ${q.ans}`;

        container.classList.add("correct-flash");
        setTimeout(()=>container.classList.remove("correct-flash"),300);

        playSound(okSound);
    }

    index++;
}

/* ================= CONTROLS ================= */

function nextQuestion(){
    if(!checked) checkAnswer(false);
    showQuestion();
}

function pressNum(n){
    if(checked) return;

    if(isMobile()){
        mobileValue += n;
        document.getElementById("mobileAnswer").textContent = mobileValue;
    }else{
        answer.value += n;
    }

    playSound(clickSound);
}


function isMobile(){
    return window.innerWidth <= 480;
}


function backspace(){

    if(isMobile()){
        mobileValue = mobileValue.slice(0,-1);
        document.getElementById("mobileAnswer").textContent = mobileValue;
    }else{
        answer.value = answer.value.slice(0,-1);
    }

    playSound(clickSound);
}


/* ================= KEYBOARD ================= */

answer.addEventListener("keydown", e => {

    // ‚úÖ ENTER ‚Äî tekshirish (ovoz yo‚Äòq)
    if(e.key === "Enter"){
        e.preventDefault();
        checkAnswer(false);
        return;
    }

    // ‚úÖ FAQAT 0‚Äì9 bosilganda click ovozi
    if(e.key >= "0" && e.key <= "9"){
        if(!checked){
            playSound(clickSound);
        }
    }
});

document.addEventListener("keydown", e => {

    if(game.style.display === "none") return;
    if(checked) return;

    // üî¢ NUMPAD va yuqori raqamlar
    if((e.key >= "0" && e.key <= "9")){
        pressNum(e.key);
        e.preventDefault();
    }

    // ‚å´ BACKSPACE
    if(e.key === "Backspace"){
        backspace();
        e.preventDefault();
    }

    // ‚èé ENTER ‚Äî javobni tekshirish
    if(e.key === "Enter"){
        checkAnswer(false);
        e.preventDefault();
    }
});



document.addEventListener("keydown", e=>{
    if(e.code === "Space" && game.style.display !== "none"){
        e.preventDefault();
        nextQuestion();
    }
});

/* ================= FINISH ================= */

function finish(){
    game.style.display = "none";
    document.getElementById("topbar").style.display = "none";


    let grade = Math.min(5,(correct/maxQuestions*5)).toFixed(2);

    let html = `
        <b>–¢–µ—Å—Ç –∞—è“õ—Ç–∞–ª–¥—ã!</b><br><br>
        <div>–ë–∞“ì–∞: ${grade}</div>
    `;

    if(wrongList.length){
        html += `
            <div class="wrong-list">
                <b>“ö–∞—Ç–µ –º—ã—Å–∞–ª–¥–∞—Ä:</b><br>
                ${wrongList.join("<br>")}
            </div>
        `;
    }

    html += `
        <div style="margin-top:20px;">
            <button onclick="location.reload()">‚Ü∫ “ö–∞–π—Ç–∞ –±–∞—Å—Ç–∞—É</button>
        </div>
    `;

    summary.innerHTML = html;

}
</script>
</body>
</html> 
